/* ======================================================
   Players Lounge — League Dashboard
   Modern dark theme, broadcast aesthetic
   ====================================================== */

/* --- Reset & Variables --- */
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
    --bg-body:      #070b1a;
    --bg-card:      #0f1629;
    --bg-card-alt:  #151d33;
    --bg-hover:     #1a2440;
    --text:         #e8ecf1;
    --text-dim:     #7b8ba3;
    --accent:       #00cfff;
    --accent-glow:  rgba(0, 207, 255, .15);
    --green:        #34d399;
    --amber:        #fbbf24;
    --red:          #f87171;
    --border:       #1e293b;
    --radius:       10px;
    --shadow:       0 2px 24px rgba(0,0,0,.45);
}

/* --- Base --- */
html { font-size: 14px; }

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg-body);
    color: var(--text);
    min-height: 100vh;
    line-height: 1.55;
}

.container {
    max-width: 1440px;
    margin: 0 auto;
    padding: 24px 20px 60px;
}

/* --- Cards --- */
.card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
}

/* --- Header --- */
header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    padding: 28px 32px 22px;
    margin-bottom: 20px;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
}

h1 {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -.03em;
    background: linear-gradient(135deg, var(--accent), var(--green));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}

.venue { font-size: .95rem; color: var(--text-dim); margin-top: 2px; }
.last-updated { font-size: .8rem; color: var(--text-dim); white-space: nowrap; }

/* --- Main --- */
main { display: flex; flex-direction: column; gap: 20px; }

/* ==============================
   Chart + Team Sidebar Row
   ============================== */
.chart-row {
    display: grid;
    grid-template-columns: 1fr 200px;
    gap: 20px;
    align-items: start;
}

/* ==============================
   Team Sidebar (RHS of chart)
   ============================== */
.team-sidebar {
    padding: 16px 14px;
    position: sticky;
    top: 24px;
    max-height: calc(100vh - 48px);
    overflow-y: auto;
}

.filter-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 12px;
}
.filter-header h3 { font-size: .8rem; text-transform: uppercase; letter-spacing: .08em; color: var(--text-dim); }

.btn-clear {
    background: transparent; border: 1px solid var(--border);
    color: var(--text-dim); font-size: .7rem; padding: 3px 10px;
    border-radius: 6px; cursor: pointer; transition: all .2s;
}
.btn-clear:hover { color: var(--accent); border-color: var(--accent); }

.team-pills { display: flex; flex-direction: column; gap: 6px; }

.team-pill {
    display: flex; align-items: center; gap: 8px;
    padding: 7px 12px; border-radius: 8px;
    font-size: .8rem; font-weight: 600; cursor: pointer;
    border: 2px solid transparent; transition: all .25s ease;
    user-select: none; background: var(--bg-card-alt); color: var(--text-dim);
    white-space: nowrap;
}
.team-pill .dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.team-pill:hover { background: var(--bg-hover); color: var(--text); }
.team-pill.active { color: #fff; border-color: currentColor; box-shadow: 0 0 12px var(--accent-glow); }

/* ==============================
   Chart Section
   ============================== */
.chart-section { padding: 20px 24px 12px; min-width: 0; }

.chart-controls {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 8px;
}

.chart-toggle {
    display: inline-flex; background: var(--bg-body);
    border-radius: 8px; padding: 3px; gap: 2px;
}

.toggle-btn {
    padding: 7px 18px; border: none; border-radius: 6px;
    font-size: .82rem; font-weight: 600; cursor: pointer;
    transition: all .2s; background: transparent; color: var(--text-dim);
}
.toggle-btn:hover { color: var(--text); }
.toggle-btn.active { background: var(--accent); color: #000; box-shadow: 0 0 10px var(--accent-glow); }

.proj-toggle {
    display: flex; align-items: center; gap: 6px;
    font-size: .8rem; color: var(--text-dim); cursor: pointer; user-select: none;
}
.proj-toggle input { accent-color: var(--accent); cursor: pointer; }

#main-chart { width: 100%; height: 520px; }

/* ==============================
   Bottom Grid — Table + Fixtures
   ============================== */
.bottom-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

.league-table-section, .fixtures-section { padding: 20px 24px; }

.league-table-section h2, .fixtures-section h2,
.predictions-section h2, .upcoming-section h2 {
    font-size: 1.1rem; font-weight: 700; color: var(--accent); margin-bottom: 4px;
}

.section-sub { font-size: .78rem; color: var(--text-dim); margin-bottom: 14px; }
.gw-date { font-size: .8rem; color: var(--text-dim); margin-bottom: 14px; }
.league-table-section .table-wrapper { margin-top: 14px; }

/* ==============================
   Tables (shared)
   ============================== */
.table-wrapper { overflow-x: auto; }
table { width: 100%; border-collapse: collapse; }

thead th {
    padding: 10px 8px; font-size: .7rem; font-weight: 700;
    text-transform: uppercase; letter-spacing: .06em;
    color: var(--text-dim); border-bottom: 2px solid var(--border);
    text-align: left; white-space: nowrap;
}

tbody td {
    padding: 9px 8px; border-bottom: 1px solid var(--border);
    font-size: .85rem; vertical-align: middle;
}
tbody tr { transition: background .15s; }
tbody tr:hover { background: var(--bg-hover); }
tbody tr:last-child td { border-bottom: none; }

.col-pos { width: 30px; text-align: center; }
.col-num { width: 36px; text-align: center; }
.col-pts { font-weight: 700; color: var(--accent) !important; }
.col-team { min-width: 110px; }
.col-score { text-align: center; white-space: nowrap; }
.col-form { width: 100px; white-space: nowrap; }

.no-data { text-align: center; color: var(--text-dim); padding: 30px 10px !important; font-style: italic; }

/* ---- League Table specifics ---- */
#league-table tbody td.pos-cell { text-align: center; font-weight: 700; color: var(--text-dim); }
#league-table tbody td.team-cell { font-weight: 600; }
#league-table tbody td.pts-cell { font-weight: 800; color: var(--accent); text-align: center; }
#league-table tbody td.num-cell { text-align: center; color: var(--text-dim); }
#league-table tbody tr { cursor: pointer; }
#league-table tbody tr.selected-row { background: var(--accent-glow) !important; }
#league-table tbody tr.selected-row td.team-cell { color: #fff; }

/* Form dots */
.form-dots { display: flex; gap: 4px; justify-content: center; }
.form-dot {
    width: 18px; height: 18px; border-radius: 4px;
    display: flex; align-items: center; justify-content: center;
    font-size: .65rem; font-weight: 800; color: #000; flex-shrink: 0;
    position: relative;
}
.form-dot.W { background: var(--green); }
.form-dot.D { background: var(--amber); }
.form-dot.L { background: var(--red); }

/* "Too late for Staggs" — bold dot with ring + cursor */
.form-dot.late-staggs {
    box-shadow: 0 0 0 2.5px #fff, 0 0 8px rgba(255,255,255,.45);
    cursor: help;
    transform: scale(1.15);
}

/* ---- Gameweek Navigation ---- */
.gw-nav {
    display: flex; align-items: center; gap: 12px;
}
.gw-nav h2 { margin-bottom: 0; white-space: nowrap; }

.gw-nav-btn {
    display: flex; align-items: center; justify-content: center;
    width: 32px; height: 32px; border-radius: 8px;
    border: 1px solid var(--border); background: var(--bg-card-alt);
    color: var(--text-dim); font-size: 1.2rem; font-weight: 700;
    cursor: pointer; transition: all .2s; line-height: 1;
    user-select: none; flex-shrink: 0;
}
.gw-nav-btn:hover:not(:disabled) { color: var(--accent); border-color: var(--accent); background: var(--bg-hover); }
.gw-nav-btn:disabled { opacity: .3; cursor: not-allowed; }

/* ---- Fixtures Table specifics ---- */
#fixtures-table .home-cell { text-align: right; font-weight: 600; padding-right: 12px; }
#fixtures-table .away-cell { text-align: left; font-weight: 600; padding-left: 12px; }
#fixtures-table .score-cell {
    text-align: center; font-weight: 800; font-size: 1rem;
    color: var(--accent); letter-spacing: .04em; min-width: 60px;
}
#fixtures-table tbody tr.selected-fixture { background: var(--accent-glow) !important; }

/* KO time above the score */
.ko-label {
    display: block; font-size: .68rem; font-weight: 500;
    color: var(--text-dim); letter-spacing: .02em; margin-bottom: 1px;
}

/* "Too late for Staggs" badge */
.staggs-badge {
    display: block; font-size: .68rem; font-weight: 600;
    color: var(--amber); margin-top: 3px; white-space: nowrap;
    cursor: help;
}
#fixtures-table tbody tr.staggs-row {
    background: rgba(251, 191, 36, .06);
}
.pts-tag { color: var(--text-dim); margin-left: 4px; }

/* ---- Analytics Wrapper ---- */
.analytics-wrapper {
    display: flex; flex-direction: column; gap: 20px;
}
.analytics-header {
    display: flex; align-items: center; gap: 12px;
    position: relative;
}
.analytics-title {
    font-size: 1.4rem; font-weight: 800;
    background: linear-gradient(135deg, var(--amber), var(--green));
    -webkit-background-clip: text; background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: -.02em;
}

/* ---- KO Heatmap ---- */
.ko-heatmap-section { padding: 20px 24px; }
.ko-heatmap-section h2 {
    font-size: 1.1rem; font-weight: 700; color: var(--accent); margin-bottom: 4px;
}

#ko-heatmap-table { border-collapse: separate; border-spacing: 0; }

#ko-heatmap-table thead th {
    position: sticky; top: 0; z-index: 2;
    background: var(--bg-card); padding: 8px 6px;
}
.col-ko {
    width: 64px; text-align: center; font-size: .72rem; white-space: nowrap;
}
.ko-overall { border-left: 2px solid var(--border); font-weight: 700; }

#ko-heatmap-table tbody td.pos-cell { text-align: center; font-weight: 700; color: var(--text-dim); width: 30px; }
#ko-heatmap-table tbody td.team-cell { font-weight: 600; min-width: 110px; white-space: nowrap; }

.ko-cell {
    text-align: center; font-weight: 700; font-size: .88rem;
    color: var(--text); padding: 8px 4px; border-radius: 4px;
    cursor: default; transition: transform .15s;
}
.ko-cell:hover { transform: scale(1.08); z-index: 1; position: relative; }
.ko-games { font-weight: 400; font-size: .65rem; color: var(--text-dim); }
.ko-empty { color: var(--text-dim); font-weight: 400; font-size: .78rem; }
.ko-overall-cell { border-left: 2px solid var(--border); font-weight: 800; }

#ko-heatmap-table tbody tr { cursor: pointer; }
#ko-heatmap-table tbody tr.selected-row { outline: 2px solid var(--accent); outline-offset: -2px; }

/* ---- Predictions + Tooltip ---- */
.predictions-section { padding: 20px 24px; }

.info-icon {
    display: inline-flex; align-items: center; justify-content: center;
    width: 22px; height: 22px; border-radius: 50%;
    background: var(--bg-card-alt); border: 1px solid var(--border);
    color: var(--accent); font-size: .82rem; font-weight: 700;
    cursor: pointer; transition: all .2s; flex-shrink: 0;
    line-height: 1;
}
.info-icon:hover, .info-icon:focus { background: var(--accent); color: #000; }

.model-tooltip {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    margin-top: 8px;
    z-index: 100;
    width: 400px;
    max-width: 90vw;
    padding: 18px 20px;
    background: var(--bg-card-alt);
    border: 1px solid var(--accent);
    border-radius: var(--radius);
    box-shadow: 0 8px 32px rgba(0, 207, 255, .18);
    font-size: .82rem;
    line-height: 1.65;
    color: var(--text);
}
.model-tooltip.visible { display: block; }
.model-tooltip strong { color: var(--accent); font-size: .9rem; display: block; margin-bottom: 8px; }
.model-tooltip p { margin-bottom: 6px; color: var(--text-dim); }
.model-tooltip .formula {
    font-family: 'SF Mono', 'Fira Code', monospace;
    background: var(--bg-body);
    padding: 6px 10px;
    border-radius: 6px;
    color: var(--amber);
    font-size: .78rem;
    margin: 6px 0;
}
.model-tooltip em { color: var(--green); font-style: normal; font-weight: 600; }
#predictions-table .home-cell { text-align: right; font-weight: 600; padding-right: 12px; }
#predictions-table .away-cell { text-align: left; font-weight: 600; padding-left: 12px; }
#predictions-table .score-cell {
    text-align: center; font-weight: 700; font-size: .95rem;
    color: var(--amber); min-width: 60px; letter-spacing: .04em;
}
#predictions-table .pct-cell { text-align: center; font-size: .82rem; color: var(--text-dim); }
#predictions-table tbody tr.selected-fixture { background: var(--accent-glow) !important; }

/* ---- Upcoming Fixtures ---- */
.upcoming-section { padding: 20px 24px; }

.upcoming-card {
    display: flex; align-items: center; gap: 16px;
    padding: 14px 18px; border-radius: 8px;
    background: var(--bg-card-alt); border: 1px solid var(--border);
    margin-bottom: 10px;
}
.upcoming-card .ko-time {
    font-size: .78rem; color: var(--text-dim); min-width: 110px;
    white-space: nowrap;
}
.upcoming-card .matchup {
    font-size: .95rem; font-weight: 600; flex: 1;
}
.upcoming-card .matchup .vs { color: var(--text-dim); margin: 0 6px; font-weight: 400; font-size: .8rem; }

/* ==============================
   Responsive
   ============================== */

@media (max-width: 1100px) {
    .chart-row { grid-template-columns: 1fr 170px; }
    .team-pill { font-size: .75rem; padding: 5px 10px; }
}

@media (max-width: 960px) {
    .bottom-grid { grid-template-columns: 1fr; }
    .chart-row { grid-template-columns: 1fr; }
    .team-sidebar {
        position: static;
        max-height: none;
    }
    .team-pills { flex-direction: row; flex-wrap: wrap; }
}

/* ---- iPhone 16 / small phones (≤430px) ---- */
@media (max-width: 640px) {
    html { font-size: 13px; }
    .container { padding: 12px 10px 40px; }
    header { flex-direction: column; align-items: flex-start; gap: 4px; padding: 16px 14px 14px; }
    h1 { font-size: 1.45rem; }

    /* Chart */
    #main-chart { height: 340px; }
    .chart-section { padding: 12px 10px 8px; }
    .chart-controls { flex-direction: column; gap: 6px; align-items: flex-start; }
    .toggle-btn { padding: 6px 12px; font-size: .78rem; }

    /* Team sidebar → compact row */
    .team-sidebar { padding: 10px 10px; }
    .team-pill { font-size: .72rem; padding: 5px 8px; border-radius: 6px; }
    .team-pill .dot { width: 8px; height: 8px; }
    .filter-header { margin-bottom: 8px; }

    /* Tables */
    .league-table-section, .fixtures-section,
    .predictions-section, .upcoming-section { padding: 12px 10px; }

    .hide-mobile { display: none !important; }

    thead th { padding: 7px 4px; font-size: .62rem; }
    tbody td { padding: 7px 4px; font-size: .78rem; }

    .col-pos { width: 22px; }
    .col-num { width: 26px; }
    .col-team { min-width: 70px; }

    #league-table tbody td.team-cell { font-size: .78rem; }
    #league-table tbody td.pts-cell { font-size: .82rem; }

    .form-dots { gap: 3px; }
    .form-dot { width: 16px; height: 16px; font-size: .58rem; }
    .form-dot.late-staggs { transform: scale(1.1); }

    /* GW nav buttons — larger touch targets on mobile */
    .gw-nav { gap: 8px; }
    .gw-nav h2 { font-size: .95rem; }
    .gw-nav-btn {
        width: 36px; height: 36px; border-radius: 50%;
        font-size: 1.3rem;
        background: var(--bg-body); border-color: var(--accent);
        color: var(--accent);
    }
    .gw-nav-btn:disabled { border-color: var(--border); color: var(--text-dim); }

    /* Analytics */
    .analytics-title { font-size: 1.15rem; }

    /* Fixtures table: stack score compactly */
    #fixtures-table .home-cell,
    #fixtures-table .away-cell { padding-left: 4px; padding-right: 4px; font-size: .78rem; }
    #fixtures-table .score-cell { font-size: .88rem; min-width: 50px; }
    .ko-label { font-size: .6rem; }
    .staggs-badge { font-size: .6rem; }

    /* KO Heatmap */
    .ko-heatmap-section { padding: 12px 10px; }
    .col-ko { width: 46px; font-size: .6rem; }
    .ko-cell { font-size: .76rem; padding: 6px 2px; }
    .ko-games { font-size: .55rem; }
    #ko-heatmap-table tbody td.team-cell { font-size: .72rem; min-width: 70px; }

    /* Predictions table */
    #predictions-table .home-cell,
    #predictions-table .away-cell { font-size: .78rem; padding-left: 4px; padding-right: 4px; }
    #predictions-table .pct-cell { font-size: .72rem; }

    /* Upcoming cards */
    .upcoming-card { padding: 10px 12px; gap: 10px; }
    .upcoming-card .ko-time { font-size: .72rem; min-width: 80px; }
    .upcoming-card .matchup { font-size: .85rem; }

    /* Model tooltip */
    .model-tooltip { width: calc(100vw - 40px); max-width: none; }
}

/* ==============================
   Plotly overrides
   ============================== */
.js-plotly-plot .plotly .modebar { background: transparent !important; }
.js-plotly-plot .plotly .modebar-btn { color: var(--text-dim) !important; }
.js-plotly-plot .plotly .modebar-btn:hover { color: var(--accent) !important; }
